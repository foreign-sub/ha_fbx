{
    "variables": {
        "img_mount_path": "/tmp/mnt",
        "playbook": "ha_fbx.yml"
    },
    "builders": [
        {
            "name": "hafbx",
            "type": "arm-image",
            "chroot_mounts": [
                [
                    "proc",
                    "proc",
                    "/proc"
                ],
                [
                    "sysfs",
                    "sysfs",
                    "/sys"
                ],
                [
                    "bind",
                    "/dev",
                    "/dev"
                ],
                [
                    "devpts",
                    "devpts",
                    "/dev/pts"
                ],
                [
                    "binfmt_misc",
                    "binfmt_misc",
                    "/proc/sys/fs/binfmt_misc"
                ]
            ],
            "image_type": "raspberrypi",
            "image_mounts": [
                "/",
                "/boot/efi"
            ],
            "iso_url": "{{user `is_url`}}",
            "iso_checksum": "none",
            "mount_path": "{{ user `img_mount_path` }}",
            "image_chroot_env": [
                "PATH=/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/bin:/sbin"
            ],
            "qemu_binary": "qemu-aarch64-static"
        }
    ],
    "provisioners": [
        {
            "type": "file",
            "source": "{{user `init_path`}}/init_ha.sh",
            "destination": "/root/init_ha.sh"
        },
        {
            "type": "file",
            "source": "{{user `init_path`}}/tasks/ha_fbx.yml",
            "destination": "/root/ha_fbx.yml"
        },
        {
            "type": "ansible",
            "playbook_file": "{{ user `playbook` }}"
        }
    ]
}